@if (TempData["message"] != null)
{
    <div class="alert @TempData["messageType"] p-3 rounded-3 text-center mb-5">
        @TempData["message"]
    </div>
}


<div class="mb-4">
    <h5>Total Orders: @ViewBag.TotalOrders</h5>
    <h5>Products in Carts: @ViewBag.TotalProductsInCarts</h5>
</div>

<div>
    @if (Model != null)
    {
        <div class="row">
            @foreach (var order in Model)
            {
                <div class="col-md-4 mb-4">
                    <div class="card shadow">
                        <div class="card-body">
                            <h4 class="card-title">Order ID: @order.OrderId</h4>
                            <p><i class="bi bi-calendar"></i> <strong>Order Date:</strong> @order.OrderDate.ToString("g")</p>

                            <form method="post" asp-controller="Orders" asp-action="UpdateStatus">
                                <input type="hidden" name="OrderId" value="@order.OrderId" />

                                <div class="form-group">
                                    <label for="Status" style="font-weight: bold">Status</label>
                                    <select class="form-control" name="Status" style="color: black;" onchange="this.form.submit();">
                                        <option value="Pending" style="color: orange;" selected="@(order.Status == "Pending")">Pending</option>
                                        <option value="Shipped" style="color: blue;" selected="@(order.Status == "Shipped")">Shipped</option>
                                        <option value="Delivered" style="color: green;" selected="@(order.Status == "Delivered")">Delivered</option>
                                        <option value="Canceled" style="color: red;" selected="@(order.Status == "Canceled")">Canceled</option>
                                    </select>
                                </div>
                            </form>

                            <p class="mt-3" style="font-weight: bold;">
                                Current Status:
                                                    <span style="color:
                            @(order.Status == "Pending" ? "orange" :
                              order.Status == "Shipped" ? "blue" :
                              order.Status == "Delivered" ? "green" :
                              order.Status == "Canceled" ? "red" : "black");">
                                                        @order.Status
                                </span>
                            </p>



                            <p><i class="bi bi-wallet2"></i> <strong>Payment:</strong> @order.PaymentMethod</p>
                            <p><i class="bi bi-house"></i> <strong>Shipping Address:</strong> @order.ShippingAddress</p>
                            <p><i class="bi bi-cart"></i> <strong>Cart ID:</strong> @order.CartId</p>
                            @if (order.Cart != null && order.Cart.User != null)
                            {
                            <p><i class="bi bi-person-circle"></i> <strong>User:</strong> @order.Cart.User.UserName</p>
                            }

                            @if (order.Cart != null && order.Cart.CartProducts != null)
                            {
                            <div class="mt-3">
                                <strong>Products in Cart:</strong>
                                <ul class="list-group list-group-flush">
                                    @foreach (var cartProduct in order.Cart.CartProducts)
                                        {
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Product ID: @cartProduct.ProductId
                                        <a asp-controller="Products" asp-action="Show" asp-route-id="@cartProduct.ProductId"
                                           class="btn btn-outline-primary btn-sm">
                                            <i class="bi bi-eye"></i> View Product
                                        </a>
                                    </li>
                                        }
                                </ul>
                            </div>
                            }

                            <div class="mt-4">
                                <a asp-controller="Orders" asp-action="Show" asp-route-orderId="@order.OrderId"
                                   class="btn btn-sm w-100 mb-2"
                                   style="background-color: #A74DBA; color: white; border: none;">
                                    <i class="bi bi-box"></i> View Order Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="text-center">
            <h5>No orders available.</h5>
        </div>
    }
</div>
